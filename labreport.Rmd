---
title: "lab report"
author: "Aaron Willcox"
date: "09/07/2018"
output: html_document
fontsize: 12pt
geometry: margin = 1.2in
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Statistics
#### To Check
Are summed variables mutated correctly? Affect sums should be mean or total score? 

```{r Included Library, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
# Included librarys for functions
library(psych)
library(haven)
library(dplyr)
library(ggplot2)
library(stargazer)
library(labelled)
```


~ FUUuuuuuu... a bloody comma!
(╯°□°）╯︵ ┻━┻


The core set of items forming the PWI comprise of seven questions of satisfaction with specific life domains as follows:

**DV:** Personal Wellbeing Index (pwi)  
**IVs:** Affect(affect), Cogniton(cognition), Gender(gender), Personality(personality)

***
## Import 
SPSS file into a data frame using the haven package
Reading SPSS-data with haven keeps the numeric values for variables and adds the value and variable labels as attributes.
```{r Import}
well_being_df <- read_sav("WellbeingFINAL.sav")

# View(well_being_df)
```

Check for missing values and that they are lower than the total number of observations. 
If number of observations with missing values are much lower than the total number of observations, then there’s not much loss of information by dropping them. 

```{r Data Check}
nrows <- nrow(well_being_df)
ncomplete <- sum(complete.cases(well_being_df))
ncomplete/nrows

# Check for missing or na data
which(is.na(well_being_df))

```

# Subsetting and variables setup

### Personal Wellbeing Index

#### How satisfied are you with...?

1. your standard of living? - Standard of Living
2. your health? - Personal Health
3. what you are achieving in life? - Achieving in Life
4. your personal relationships? - Personal Relationships
5. how safe you feel? - Personal Safety
6. feeling part of your community? - Community-Connectedness
7. your future security? - Future Security

Data derived on the Personal Wellbeing Index scale items may be used either at the level of individual domains, or the domain scores may be aggregated and averaged to form the Personal Wellbeing Index (PWI).

```{r Subjective WellBeing}
well_being_df <- well_being_df %>% #PWI Variable - need to select for each domain
 # mutate(pwi_index = rowSums(select(., contains("PWI")))) #Was only summing totoal scores not case average
   mutate(pwi_index = rowSums(select(., contains("PWI")))/7*10) #This sums score for each case and computes mean

```

### Personality 
#### NEO-PI
1. Openness
2. Consciencious
3. Extraversion
4. Agreeable
5. Neurotic
```{r Personality}

# well_being_df <- well_being_df %>% 
#  mutate(Personality = rowSums(select(., contains("Personality")))) #Personality -- Dont need overal personality score only for each type

#Compute new variables for each personality domain - total score for each case
well_being_df <- well_being_df %>% 
  mutate(Open = rowSums(select(well_being_df, num_range("Personality", 1:10)))) %>%
  mutate(Consciencious = rowSums(select(well_being_df, num_range("Personality", 11:20)))) %>%
  mutate(Extraversion = rowSums(select(well_being_df, num_range("Personality", 21:30))) ) %>%
  mutate(Agreeable = rowSums(select(well_being_df, num_range("Personality", 31:40))) ) %>%
  mutate(Neurotic = rowSums(select(well_being_df, num_range("Personality", 41:50))))


```


### Affect (HPMood) 
#### Homeostatically Protected Mood
1. Happy
2. Content
3. Excited

```{r Affect}
well_being_df <- well_being_df %>% 
  mutate(affect = rowSums(select(., contains("Affect")))/3) #Affect variable to new column

#Homeostatic Mood 
names(well_being_df)[61] <- "Happy" #rename HPMood labels 
names(well_being_df)[62] <- "Content"
names(well_being_df)[63] <- "Alert"
affect.Means <- colSums(well_being_df[61:63]/169)#column means for each affect
#HPMood <- c("Happy", "Content", "Alert") #create labels for columns
#cbind(HPMood, as.numeric(affect.Means)) #combine and display 
affect.Means

```


### Multiple Discrepancies Theory (MDT) - Cognition
1. Self Best
2. Self Future
3. Self Progress
4. Self Needs
5. Self Deserves
6. Self Other
7. Self Wants

```{r MDT Cognition}
well_being_df <- well_being_df %>% 
  mutate(cognition = rowSums(select(., contains("Cognition")))/7) #Cognition

# colSums(select(well_being_df, num_range("Cognition", 1:7)))
```

## Results

1. create an object and pull the PWI columns then rename
2. Create a data frame with used variables

```{r Results}
#create an object with label names
Personal.Wellbeing.Index <- c("Standard of Living", "Personal Health", "Achieving in Life", "Personal Relationships", "Personal Safety", "Community", "Future Security")

Subjective.Wellbeing <- cbind(well_being_df[4:10]) #create an object with PWI columns
names(Subjective.Wellbeing) <- Personal.Wellbeing.Index # rename columns as set out in Personal.Wellbeing.Index
HPMood <- cbind(well_being_df[,61:63]) 

attach(well_being_df)
# big5 <- data.frame(Open, Consciencious, Extraversion, Agreeable, Neurotic) #object with NEO-PI-R
df.all <- data.frame(pwi_index, affect, cognition, Open, Consciencious, Extraversion, Agreeable, Neurotic)

detach(well_being_df)
attach(df.all)

corr.test(df.all)
# Anova(lm(formula = df.all$pwi_index ~ df.all$affect + df.all$cognition + df.all$Open + df.all$Consciencious + df.all$Extraversion))

#create a model to see the which is the potential strongest predictor for SWB:
my.model <- lm(formula = pwi_index ~ 
                 affect + 
                 cognition +
                 Open +
                 Consciencious +
                 Extraversion +
                 Agreeable +
                 Neurotic
               )

SWB.Anova <- anova(my.model) #run an ANOVA 

#Using the stargazer package to output cleaner tables 
stargazer(df.all, HPMood, 
          title = "Descriptives",
          type = "text", 
          style = "all", 
          summary = TRUE, 
          ci = FALSE, digits = 2)

stargazer(HPMood, 
          title = "Descriptives",
          type = "text", 
          style = "all", 
          summary = TRUE, 
          ci = FALSE, digits = 2)

stargazer(my.model, SWB.Anova,
          title = "Results",
          type = "text", 
          style = "all", 
          summary = TRUE, 
          dep.var.labels = "Personal Wellbeing Index", 
          ci = FALSE, digits = 2) #the text prints table to the Console

```

### Plots 
```{r Histogram and Plots}
# Personal Wellbeing and Cognition
ggplot(data = df.all, aes(x = cognition, y = pwi_index)) +
  geom_point(aes(color = "red")) +
  theme_bw() +
  ggtitle("Subjective Wellbeing Model") +
  theme( plot.title = element_text(vjust = 1.0) ) +
  xlab("Multiple Discrepancy Theory (Cognition)") +
  theme( axis.title.x = element_text(vjust = -.5) ) +
  ylab("Personal Wellbeing Index") +
  theme( axis.title.y = element_text(vjust = 1.0) ) +
  theme(legend.position = "bottom")


# Personal wellbeing and HPMood
ggplot(data = df.all, aes(x = affect, y = pwi_index)) +
  geom_point(aes(color = "red")) +
  theme_bw() +
  ggtitle("Subjective Wellbeing Model") +
  theme( plot.title = element_text(vjust = 1.0) ) +
  xlab("Homeostasis Mood Index (Affect)") +
  theme( axis.title.x = element_text(vjust = -.5) ) +
  ylab("Personal Wellbeing Index") +
  theme( axis.title.y = element_text(vjust = 1.0) ) +
  theme(legend.position = "bottom")


```
***

┬─┬ノ(ಠ_ಠノ) ~Ok its fixed. 
