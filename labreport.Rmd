---
title: "lab report"
author: "Aaron Willcox"
date: "09/07/2018"
output: html_document
fontsize: 12pt
geometry: margin = 1.2in
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r}
# Included librarys for functions
library(psych)
library(haven)
library(dplyr)
library(broom)
library(labelled)
```

# import 
SPSS file into a data frame using the haven package
Reading SPSS-data with haven keeps the numeric values for variables and adds the value and variable labels as attributes.

```{r}

well_being_df <- read_sav("WellbeingFINAL.sav")
attach(well_being_df)
View(well_being_df)
```

**DV:** Personal Wellbeing Index (pwi)  
**IVs:** Affect(affect), Cogniton(cognition), Gender(gender), Personality(personality), Employment(employment).


Check for missing values and that they are lower than the total number of observations. 
If number of observations with missing values are much lower than the total number of observations, then thereâ€™s not much loss of information by dropping them. 
```{r}
nrows <- nrow(well_being_df)
ncomplete <- sum(complete.cases(well_being_df))
ncomplete/nrows
```


# Take a look at the data
```{r}
colnames(well_being_df)
describe(well_being_df)
```

# Check for missing or na data
```{r}
which(is.na(well_being_df))
```

# Subsetting and variables setup


Thanks to some Stackexchange help, I can now coerce the dummy codings to their labels. The select() function cannot handle character strings as arguments.
This might become a problem when column names are given as a string vector for example.
To solve this problem, the select_() function was equipped in dplyr
```{r}
#for each gender summarise the mean, sd, min and max values 1 = Male, 2 = Female and 3 = Transgender
Gender <- select(well_being_df, Gender, Age) %>%
  mutate(Gender = labelled::to_factor(Gender)) %>%
  group_by(Gender) %>%
  summarise_all(funs(mean, n = n(), sd, min(.,is.na = TRUE), max(.,is.na = TRUE)))
Gender

#For each employment status (1:5) summarise mean, sd min and max values 
Employment <- select(well_being_df, EmploymentStatus, Gender) %>% 
  mutate(EmploymentStatus = labelled::to_factor(EmploymentStatus)) %>% # use labelled package 
  group_by(EmploymentStatus) %>% 
  summarise_all(funs(mean, n = n(), sd,min(.,is.na = TRUE), max(.,is.na = TRUE)))
Employment

#Create a new variable for the Personal Wellbeing Index 
x <- select(well_being_df) %>% mutate(pwi_index = well_being_df$PWI1 + well_being_df$PWI2 + well_being_df$PWI3 + well_being_df$PWI4 + well_being_df$PWI5 + well_being_df$PWI6 + well_being_df$PWI7)

Gender <- well_being_df$Gender

cognition <- Cognition1 + Cognition2 + Cognition3 + Cognition4 + Cognition5 + Cognition6 + Cognition7

affect <- well_being_df$Affect1 + well_being_df$Affect2 + well_being_df$Affect3

pwi_index <- well_being_df$PWI1 + well_being_df$PWI2 + well_being_df$PWI3 + well_being_df$PWI4 + well_being_df$PWI5 + well_being_df$PWI6 + well_being_df$PWI7

personality <- rowSums(well_being_df[,11:60]) #doesnt save labels

#create a model
lm(formula = pwi_index ~ affect + cognition + personality + Gender)


```

```{r}
stargazer(Employment)
```



***
The core set of items forming the PWI comprise of seven questions of satisfaction with specific life domains as follows:

##### Questions
|How satisfied are you with...? | Domains |
1. your standard of living? | Standard of Living |
2. your health?| Personal Health |
3. what you are achieving in life?| Achieving in Life |
4. your personal relationships?|  Personal Relationships |
5. how safe you feel?| Personal Safety |
6. feeling part of your community?| Community-Connectedness|
7. your future security?|  Future Security|


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
